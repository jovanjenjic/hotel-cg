{"version":3,"sources":["../src/index.tsx"],"sourcesContent":["/* eslint-disable max-len */\r\n\r\n/**\r\n *\r\n * NextTopLoader\r\n *\r\n */\r\n\r\n/* eslint-disable prefer-const */\r\n/* eslint-disable quotes */\r\n\r\nimport * as PropTypes from 'prop-types';\r\nimport * as React from 'react';\r\nimport * as NProgress from 'nprogress';\r\nexport type NextTopLoaderProps = {\r\n  /**\r\n   * Color for the TopLoader.\r\n   * @default \"#29d\"\r\n   */\r\n  color?: string;\r\n  /**\r\n   * The initial position for the TopLoader in percentage, 0.08 is 8%.\r\n   * @default 0.08\r\n   */\r\n  initialPosition?: number;\r\n  /**\r\n   * The increament delay speed in milliseconds.\r\n   * @default 200\r\n   */\r\n  crawlSpeed?: number;\r\n  /**\r\n   * The height for the TopLoader in pixels (px).\r\n   * @default 3\r\n   */\r\n  height?: number;\r\n  /**\r\n   * Auto increamenting behaviour for the TopLoader.\r\n   * @default true\r\n   */\r\n  crawl?: boolean;\r\n  /**\r\n   * To show spinner or not.\r\n   * @default true\r\n   */\r\n  showSpinner?: boolean;\r\n  /**\r\n   * Animation settings using easing (a CSS easing string).\r\n   * @default \"ease\"\r\n   */\r\n  easing?: string;\r\n  /**\r\n   * Animation speed in ms for the TopLoader.\r\n   * @default 200\r\n   */\r\n  speed?: number;\r\n  /**\r\n   * Defines a shadow for the TopLoader.\r\n   * @default \"0 0 10px ${color},0 0 5px ${color}\"\r\n   *\r\n   * @ you can disable it by setting it to `false`\r\n   */\r\n  shadow?: string | false;\r\n}\r\n\r\nconst NextTopLoader = ({\r\n  color: propColor,\r\n  height: propHeight,\r\n  showSpinner,\r\n  crawl,\r\n  crawlSpeed,\r\n  initialPosition,\r\n  easing,\r\n  speed,\r\n  shadow,\r\n}: NextTopLoaderProps) => {\r\n  const defaultColor = '#29d';\r\n  const defaultHeight = 3;\r\n\r\n  const color = propColor ?? defaultColor;\r\n  const height = propHeight ?? defaultHeight;\r\n\r\n  // Any falsy (except undefined) will disable the shadow\r\n  const boxShadow = !shadow && shadow !== undefined\r\n    ? ''\r\n    : shadow\r\n      ? `box-shadow:${shadow}`\r\n      : `box-shadow:0 0 10px ${color},0 0 5px ${color}`;\r\n\r\n  const styles = (\r\n    <style>\r\n      {`#nprogress{pointer-events:none}#nprogress .bar{background:${\r\n        color\r\n      };position:fixed;z-index:1031;top:0;left:0;width:100%;height:${\r\n        height\r\n      }px}#nprogress .peg{display:block;position:absolute;right:0;width:100px;height:100%;${\r\n        boxShadow\r\n      };opacity:1;-webkit-transform:rotate(3deg) translate(0px,-4px);-ms-transform:rotate(3deg) translate(0px,-4px);transform:rotate(3deg) translate(0px,-4px)}#nprogress .spinner{display:block;position:fixed;z-index:1031;top:15px;right:15px}#nprogress .spinner-icon{width:18px;height:18px;box-sizing:border-box;border:2px solid transparent;border-top-color:${\r\n        color\r\n      };border-left-color:${\r\n        color\r\n      };border-radius:50%;-webkit-animation:nprogress-spinner 400ms linear infinite;animation:nprogress-spinner 400ms linear infinite}.nprogress-custom-parent{overflow:hidden;position:relative}.nprogress-custom-parent #nprogress .bar,.nprogress-custom-parent #nprogress .spinner{position:absolute}@-webkit-keyframes nprogress-spinner{0%{-webkit-transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg)}}@keyframes nprogress-spinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}`}\r\n    </style>\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    NProgress.configure({\r\n      showSpinner: showSpinner ?? true,\r\n      trickle: crawl ?? true,\r\n      trickleSpeed: crawlSpeed ?? 200,\r\n      minimum: initialPosition ?? 0.08,\r\n      easing: easing ?? 'ease',\r\n      speed: speed ?? 200,\r\n    });\r\n\r\n    function isAnchorOfCurrentUrl(currentUrl: string, newUrl: string) {\r\n      const currentUrlObj = new URL(currentUrl);\r\n      const newUrlObj = new URL(newUrl);\r\n      // Compare hostname, pathname, and search parameters\r\n      if (\r\n        currentUrlObj.hostname === newUrlObj.hostname &&\r\n        currentUrlObj.pathname === newUrlObj.pathname &&\r\n        currentUrlObj.search === newUrlObj.search\r\n      ) {\r\n        // Check if the new URL is just an anchor of the current URL page\r\n        const currentHash = currentUrlObj.hash;\r\n        const newHash = newUrlObj.hash;\r\n        return (\r\n          currentHash !== newHash && currentUrlObj.href.replace(currentHash, '') === newUrlObj.href.replace(newHash, '')\r\n        );\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // eslint-disable-next-line no-var\r\n    var npgclass = document.querySelectorAll('html');\r\n    function findClosestAnchor(element: HTMLElement | null): HTMLAnchorElement | null {\r\n      while (element && element.tagName.toLowerCase() !== 'a') {\r\n        element = element.parentElement;\r\n      }\r\n      return element as HTMLAnchorElement;\r\n    }\r\n    function handleClick(event: MouseEvent) {\r\n      try {\r\n        const target = event.target as HTMLElement;\r\n        const anchor = findClosestAnchor(target);\r\n        if (anchor) {\r\n          const currentUrl = window.location.href;\r\n          const newUrl = (anchor as HTMLAnchorElement).href;\r\n          const isExternalLink = (anchor as HTMLAnchorElement).target === \"_blank\";\r\n          const isAnchor = isAnchorOfCurrentUrl(currentUrl, newUrl);\r\n          if (newUrl === currentUrl || isAnchor || isExternalLink) {\r\n            NProgress.start();\r\n            NProgress.done();\r\n            [].forEach.call(npgclass, function (el: Element) {\r\n              el.classList.remove(\"nprogress-busy\");\r\n            });\r\n          } else {\r\n            NProgress.start();\r\n            (function (history) {\r\n              const pushState = history.pushState;\r\n              history.pushState = function () {\r\n                NProgress.done();\r\n                [].forEach.call(npgclass, function (el: Element) {\r\n                  el.classList.remove(\"nprogress-busy\");\r\n                });\r\n                // eslint-disable-next-line prefer-rest-params, @typescript-eslint/no-explicit-any\r\n                return pushState.apply(history, arguments as any);\r\n              };\r\n            })(window.history);\r\n          }\r\n        }\r\n      } catch (err) {\r\n        // Log the error in development only!\r\n        // console.log('NextTopLoader error: ', err);\r\n        NProgress.start();\r\n        NProgress.done();\r\n      }\r\n    }\r\n\r\n    // Add the global click event listener\r\n    document.addEventListener(\"click\", handleClick);\r\n\r\n    // Clean up the global click event listener when the component is unmounted\r\n    return () => {\r\n      document.removeEventListener(\"click\", handleClick);\r\n    };\r\n  }, []);\r\n\r\n  return styles;\r\n};\r\nexport default NextTopLoader;\r\n\r\nNextTopLoader.propTypes = {\r\n  color: PropTypes.string,\r\n  height: PropTypes.number,\r\n  showSpinner: PropTypes.bool,\r\n  crawl: PropTypes.bool,\r\n  crawlSpeed: PropTypes.number,\r\n  initialPosition: PropTypes.number,\r\n  easing: PropTypes.string,\r\n  speed: PropTypes.number,\r\n  shadow: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.bool,\r\n  ]),\r\n};\r\n"],"mappings":"gmBAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GAWA,IAAAI,EAA2B,yBAC3BC,EAAuB,oBACvBC,EAA2B,wBAmD3B,IAAMC,EAAgBC,EAAA,CAAC,CACrB,MAAOC,EACP,OAAQC,EACR,YAAAC,EACA,MAAAC,EACA,WAAAC,EACA,gBAAAC,EACA,OAAAC,EACA,MAAAC,EACA,OAAAC,CACF,IAA0B,CAIxB,IAAMC,EAAQT,GAHO,OAIfU,EAAST,GAAc,EAGvBU,EAAY,CAACH,GAAUA,IAAW,OACpC,GACAA,EACE,cAAcA,IACd,uBAAuBC,aAAiBA,IAExCG,EACJ,gBAAC,aACE,6DACCH,gEAEAC,uFAEAC,kWAEAF,uBAEAA,yeAEJ,EAGF,OAAM,YAAU,IAAM,CACV,YAAU,CAClB,YAAaP,GAAe,GAC5B,QAASC,GAAS,GAClB,aAAcC,GAAc,IAC5B,QAASC,GAAmB,IAC5B,OAAQC,GAAU,OAClB,MAAOC,GAAS,GAClB,CAAC,EAED,SAASM,EAAqBC,EAAoBC,EAAgB,CAChE,IAAMC,EAAgB,IAAI,IAAIF,CAAU,EAClCG,EAAY,IAAI,IAAIF,CAAM,EAEhC,GACEC,EAAc,WAAaC,EAAU,UACrCD,EAAc,WAAaC,EAAU,UACrCD,EAAc,SAAWC,EAAU,OACnC,CAEA,IAAMC,EAAcF,EAAc,KAC5BG,EAAUF,EAAU,KAC1B,OACEC,IAAgBC,GAAWH,EAAc,KAAK,QAAQE,EAAa,EAAE,IAAMD,EAAU,KAAK,QAAQE,EAAS,EAAE,EAGjH,MAAO,EACT,CAjBSpB,EAAAc,EAAA,wBAoBT,IAAIO,EAAW,SAAS,iBAAiB,MAAM,EAC/C,SAASC,EAAkBC,EAAuD,CAChF,KAAOA,GAAWA,EAAQ,QAAQ,YAAY,IAAM,KAClDA,EAAUA,EAAQ,cAEpB,OAAOA,CACT,CALSvB,EAAAsB,EAAA,qBAMT,SAASE,EAAYC,EAAmB,CACtC,GAAI,CACF,IAAMC,EAASD,EAAM,OACfE,EAASL,EAAkBI,CAAM,EACvC,GAAIC,EAAQ,CACV,IAAMZ,EAAa,OAAO,SAAS,KAC7BC,EAAUW,EAA6B,KACvCC,EAAkBD,EAA6B,SAAW,SAC1DE,EAAWf,EAAqBC,EAAYC,CAAM,EACpDA,IAAWD,GAAcc,GAAYD,GAC7B,QAAM,EACN,OAAK,EACf,CAAC,EAAE,QAAQ,KAAKP,EAAU,SAAUS,EAAa,CAC/CA,EAAG,UAAU,OAAO,gBAAgB,CACtC,CAAC,IAES,QAAM,EACf,SAAUC,EAAS,CAClB,IAAMC,EAAYD,EAAQ,UAC1BA,EAAQ,UAAY,UAAY,CAC9B,OAAU,OAAK,EACf,CAAC,EAAE,QAAQ,KAAKV,EAAU,SAAUS,EAAa,CAC/CA,EAAG,UAAU,OAAO,gBAAgB,CACtC,CAAC,EAEME,EAAU,MAAMD,EAAS,SAAgB,CAClD,CACF,EAAG,OAAO,OAAO,GAGvB,MAAE,CAGU,QAAM,EACN,OAAK,CACjB,CACF,CApCS,OAAA/B,EAAAwB,EAAA,eAuCT,SAAS,iBAAiB,QAASA,CAAW,EAGvC,IAAM,CACX,SAAS,oBAAoB,QAASA,CAAW,CACnD,CACF,EAAG,CAAC,CAAC,EAEEX,CACT,EA7HsB,iBA8HfoB,EAAQlC,EAEfA,EAAc,UAAY,CACxB,MAAiB,SACjB,OAAkB,SAClB,YAAuB,OACvB,MAAiB,OACjB,WAAsB,SACtB,gBAA2B,SAC3B,OAAkB,SAClB,MAAiB,SACjB,OAAkB,YAAU,CAChB,SACA,MACZ,CAAC,CACH","names":["src_exports","__export","src_default","__toCommonJS","PropTypes","React","NProgress","NextTopLoader","__name","propColor","propHeight","showSpinner","crawl","crawlSpeed","initialPosition","easing","speed","shadow","color","height","boxShadow","styles","isAnchorOfCurrentUrl","currentUrl","newUrl","currentUrlObj","newUrlObj","currentHash","newHash","npgclass","findClosestAnchor","element","handleClick","event","target","anchor","isExternalLink","isAnchor","el","history","pushState","src_default"]}